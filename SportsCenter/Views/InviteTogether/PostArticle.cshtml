
<script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
<script src="//cdn.ckeditor.com/4.14.0/standard/ckeditor.js"></script>



@* <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">*@
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>

<style>
	.PostArticle {
		position: relative;
		padding: 5px 20px;
		margin: 0px 10px 10px 0px;
		border-radius: 3px;
		font-size: 20px;
		color: #FFF;
		text-decoration: none;
		background-color: #2ecc71;
		border: none;
		border-bottom: 5px solid #27ae60;
		text-shadow: 0px -2px #27ae60;
		-webkit-transition: all 0.1s;
		transition: all 0.1s;
	}

		.PostArticle:hover, .PostArticle:active {
			-webkit-transform: translate(0px,5px);
			-ms-transform: translate(0px,5px);
			transform: translate(0px,5px);
			border-bottom: 1px solid #2ecc71;
		}

	.CancelArticle {
		position: relative;
		padding: 5px 20px;
		margin: 0px 10px 10px 0px;
		border-radius: 3px;
		font-size: 20px;
		color: #FFF;
		text-decoration: none;
		background-color: #6C757D;
		border: none;
		border-bottom: 5px solid #6C757D;
		text-shadow: 0px -2px #6C757D;
		-webkit-transition: all 0.1s;
		transition: all 0.1s;
	}

		.CancelArticle:hover, .CancelArticle:active {
			-webkit-transform: translate(0px,5px);
			-ms-transform: translate(0px,5px);
			transform: translate(0px,5px);
			border-bottom: 1px solid #6C757D;
		}
</style>

<div class="back_re">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="title">
					<h2>揪團去</h2>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="container">

	<div class="row">

		<div class="col-md-8 offset-2 mt-5">

			<div class="card">

				<div class="card-header text-center" style="background-color: #2ecc71">

					<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-calendar-check" viewBox="0 0 16 16" style="color:white;">
						<path d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z" />
						<path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
					</svg>
					<label style="bottom:-0.5rem;"><h2 class="text-white " style="bottom:-0.5rem;"><strong>新增貼文</strong></h2></label>

				</div>

				<div class="card-body">

					<form method="post" action="" enctype="multipart/form-data">
						<div class="form-group">
							<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-dribbble" viewBox="0 0 16 16">
								<path fill-rule="evenodd" d="M8 0C3.584 0 0 3.584 0 8s3.584 8 8 8c4.408 0 8-3.584 8-8s-3.592-8-8-8zm5.284 3.688a6.802 6.802 0 0 1 1.545 4.251c-.226-.043-2.482-.503-4.755-.217-.052-.112-.096-.234-.148-.355-.139-.33-.295-.668-.451-.99 2.516-1.023 3.662-2.498 3.81-2.69zM8 1.18c1.735 0 3.323.65 4.53 1.718-.122.174-1.155 1.553-3.584 2.464-1.12-2.056-2.36-3.74-2.551-4A6.95 6.95 0 0 1 8 1.18zm-2.907.642A43.123 43.123 0 0 1 7.627 5.77c-3.193.85-6.013.833-6.317.833a6.865 6.865 0 0 1 3.783-4.78zM1.163 8.01V7.8c.295.01 3.61.053 7.02-.971.199.381.381.772.555 1.162l-.27.078c-3.522 1.137-5.396 4.243-5.553 4.504a6.817 6.817 0 0 1-1.752-4.564zM8 14.837a6.785 6.785 0 0 1-4.19-1.44c.12-.252 1.509-2.924 5.361-4.269.018-.009.026-.009.044-.017a28.246 28.246 0 0 1 1.457 5.18A6.722 6.722 0 0 1 8 14.837zm3.81-1.171c-.07-.417-.435-2.412-1.328-4.868 2.143-.338 4.017.217 4.251.295a6.774 6.774 0 0 1-2.924 4.573z" />
							</svg>
							<label><strong>類型</strong></label>
							<div>
								<select id="GetCategory" class="form-select" aria-label="Default select example">

									<option value="" selected disabled>請選擇...</option>

								</select>
							</div>
						</div>
						<div class="form-group">
							<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-file-font" viewBox="0 0 16 16">
								<path d="M10.943 4H5.057L5 6h.5c.18-1.096.356-1.192 1.694-1.235l.293-.01v6.09c0 .47-.1.582-.898.655v.5H9.41v-.5c-.803-.073-.903-.184-.903-.654V4.755l.298.01c1.338.043 1.514.14 1.694 1.235h.5l-.057-2z" />
								<path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z" />
							</svg>

							<label><strong>標題</strong></label>

							<input id="title" type="text" name="name" class="form-control" />

						</div>

						<div class="form-group">

							<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-chat-right-text" viewBox="0 0 16 16">
								<path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1H2zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12z" />
								<path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z" />
							</svg>
							<label><strong>內容</strong></label>

							<textarea class="ckeditor form-control" name="txtarea" id="txtarea">
							
							</textarea>
							<label@* class="btn btn-info" style="color:aliceblue"*@>
								@*<input type="text" name="name" id="name" />*@
								<input type="file" name="files" id="files"   />
								@*<i class="fa fa-photo"></i> 上傳圖片*@
							</label>

						</div>

						<div class="form-group text-center">

							<a type="button" class="CancelArticle" asp-controller="InviteTogether" asp-action="Index" style="text-decoration:none; color:white" >取消</a>
							<button id="PostArticle" type="button" class="PostArticle">發文</button>

						</div>

					</form>

				</div>

			</div>

		</div>

	</div>

</div>


<script type="text/javascript">
	CKEDITOR.replace('txtarea', { customConfig: '/js/ckeditor/CKconfig.js' });
</script>





<script type="text/javascript">

	$("#PostArticle").on("click", function () {
		let categoryId = $("#GetCategory").find(":selected").val();
		let title = $("#title").val();
		let content = CKEDITOR.instances.txtarea.getData();
		var files = $('#files')[0].files;
		let formData = new FormData();
        formData.append('CategoryId', categoryId);
		formData.append('content', content);
		formData.append('title', title);
		formData.append('files', files[0]);

		fetch("/api/PostArticle/post", {
			body: formData,
			method: 'POST'
		})
			.then(function (response) { return response.text() })
			.then(function (result) {
				console.log("rsl:" + result)
				if (result == "true") {
					console.log("good");
					window.location.assign("/invitetogether/index");
				}
				else {
					console.log("false")
				}
			})

	})

	//下拉選單
	$.ajax({
		url: '/api/PostArticle/GetInviteCategoryid',
		data: {
			sportCategory: [],
		},
		type: 'get',
		datatype: 'json',
		success: function (data) {
			if (data.length > 0) {
                console.log(data);
				$('#GetCategory').empty();
				$('#GetCategory').append($('<option selected disabled></option>').val('').text('--請選擇種類--'));
				//測試data是否有值
				//$('#GetCategory').append($('<option></option>').val('').text(data[0].name));
				for (i = 0; i < data.length; i++) {
                    $('#GetCategory').append(`<option value="${data[i].categoryId}"> ${data[i].name} </option>`);
				}
				//show data 迴圈
				// $('#GetCategory').append($('<option></option>').val('').text.get(data));
				// $.each(data, function (i, item) {
				//     $('#GetCategory').append($('<option>', {
				//         value: i,
				//         text: item
				//     }));
				// })
			}
		}
	})
</script>







